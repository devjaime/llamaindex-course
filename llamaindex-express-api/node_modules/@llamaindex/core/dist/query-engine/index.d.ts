import { MessageContent } from '../llms/index.js';
import { EngineResponse, NodeWithScore } from '../schema/index.js';

/**
 * @link https://docs.llamaindex.ai/en/stable/api_reference/schema/?h=querybundle#llama_index.core.schema.QueryBundle
 *
 *  We don't have `image_path` here, because it is included in the `query` field.
 */
type QueryBundle = {
    query: MessageContent;
    customEmbeddings?: string[];
    embeddings?: number[];
};
type QueryType = string | QueryBundle;
interface BaseQueryEngine {
    query(strOrQueryBundle: QueryType, stream: true): Promise<AsyncIterable<EngineResponse>>;
    query(strOrQueryBundle: QueryType, stream?: false): Promise<EngineResponse>;
    synthesize?(strOrQueryBundle: QueryType, nodes: NodeWithScore[], additionalSources?: Iterator<NodeWithScore>): Promise<EngineResponse>;
}

export type { BaseQueryEngine, QueryBundle, QueryType };
